## 1. 数据处理

* 用procd.py处理原数据（如GSE189792_Processed_data.xlsx），保留指定行，过滤全零行
* 手动清除带有‘1’的列名，无用（属于原实验修正/处理的结果，为非原始测量的数据）cleaned_data.xlsx

## 2. 数据二次处理取组间平均值进行对比

* cal_mean.py 计算组间平均值 并得到五个CSV (clea.csv down up specific_gf/scfa),可以通过命令行参数 -f 和 -p 来指定,目前默认log2fc为1，p小于等于0.05才会保留。这样输出文件就可以直接进行映射了，序列号5


## 3. 基因映射通路

直接用clear.csv 进行calc_means.py，输出五个文件，包含了上调下调的基因，刺是没有取差异性基因，且未去重，得到cle4.csv（已经是P值保留后的结果。）

* (直接映射)进行通路富集分析 enrich.py代码中的库 自己指定-i 输入文件  -o 输出文件  -k 数据库  -l 查看多少库，库名称 -p 指定p值 -n 指定前几行?

## 4. 取差异性基因

* 从cle4.csv中提取reject_null为TRUE的行（diff_genes.py），得到diff_genes.csv以及一系列其他文件

## 5. 跟sage数据差异性基因取交集

* 两个数据集中的基因名取交集，后去重，得到non_common.csv, 暂存results中的jiaoji文件夹。后续映射通路和互作。

## 5. 剩余单组数据处理

- 两个数据集的差异性基因可自行进行通路映射和互作。 逻辑同上

## 6. 关键词搜索

* autophage_search.py 关键词搜索，utils是必要的文件夹
  结果呈现多个，具体见代码搜索词。

# 关于通路设想

猜想1: SCFAs-HDAC-M2极化-针刺对哮喘的调节
科学基础:
SCFAs（特别是丁酸盐）是公认的组蛋白去乙酰化酶(HDAC)抑制剂
HDAC抑制可以促进巨噬细胞向M2型（抗炎）极化
M2型巨噬细胞在哮喘炎症控制中发挥重要作用
针灸已被证明可以调节免疫细胞极化
研究价值:
揭示针灸通过SCFAs-HDAC-M2轴调节哮喘的分子机制
连接传统针灸与现代表观遗传学研究
为针灸与丁酸钠联合治疗提供理论基础
猜想2: SCFA-T细胞-针刺-哮喘s
科学基础:
SCFAs已被证明可以影响T细胞分化和功能
SCFAs促进Treg细胞产生和抑制Th2、Th17反应
哮喘的核心病理与Th1/Th2失衡和Treg功能缺陷相关
针灸可以调节T细胞亚群平衡和功能
研究价值:
阐明针灸通过调节肠道SCFAs进而影响肺部T细胞反应的机制
探索针灸-SCFAs-T细胞轴在哮喘发病和治疗中的作用
为发现新的免疫调节靶点提供线索
猜想3: SCFAs-针刺-肺部FFAR表达
科学基础:
FFARs (特别是FFAR2/GPR43和FFAR3/GPR41)是SCFAs的关键受体
肺部确实表达这些受体，尤其是上皮细胞和免疫细胞
SCFAs通过FFAR信号影响细胞功能和炎症反应
G蛋白偶联受体信号通路是针灸调节的已知靶点
研究价值:
探究针灸是否/如何调节肺部FFAR表达
揭示SCFAs-FFAR信号在针灸治疗哮喘中的作用
建立"肠-肺轴"与针灸疗效之间的分子联系

# 关于cal_mean.py中的 P值计算有变化

* 首先一组有表达，一组无表达的处理：表达水平越高（gf_mean/np.max(gf_vals)越大）；变异越小（1-gf_cv越大）；P值就越小；最终P值被限制在[1e-10, 0.05]范围内
* 两组皆表达的情况：首先计算相对差异（relative_diff）和平均变异系数（avg_cv）；如果相对差异和变异都小于10%，认为两组没有显著差异，p_val = 1.0；否则使用Welch's t-test计算p值（不假设两组方差相等）
* 最后，对所有P值进行多重检验校正
* 可避免统计检验中出现零方差的问题。显著性更可靠。————对特异性表达和肺特异性表达采用不同计算方法，多重检验校正控制假阳性率

# 关于基因名重复的问题

   为避免后续可视化时，基因名重复，使用non_duplicate_genes.py处理，输出文件为nondu.csv.基因数量从30000+减少到10000+，文件可用于热图和火山图可视化（gene_analysis.py处理）

# 关于基因映射通路

* 使用gseapy进行富集分析 enrich.py代码中的库 自己指定-i 输入文件  -o 输出文件  -k 数据库  -l 查看多少库，库名称 -p 指定p值 -n 指定前几行?

